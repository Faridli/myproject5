{% extends "dashboard/dashboard.html" %}
{% block title %}Company Details{% endblock title %}
{% block tasks %}

{% if hq_mode %}
  <!-- üü® Bn HQ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø: ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡ßß‚Äì‡ßÆ ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ -->
  <div class="max-w-7xl mx-auto mt-10 space-y-12">
    {% for data in all_company_data %}
    <div class="bg-white rounded-2xl shadow-lg p-6 border border-amber-200">
      <div class="flex justify-between items-center mb-4 border-b pb-3">
        <h2 class="text-2xl font-bold text-amber-700">üè¢ {{ data.company.name }}</h2>
        <span class="text-gray-700 bg-amber-100 px-4 py-1 rounded-full shadow-inner">
          Total Members: {{ data.member_count }}
        </span>
      </div>

      <!-- ‚úÖ Force-wise summary -->
      <div class="mb-4">
        <h3 class="text-lg text-center bg-green-100 font-semibold mb-2 ">Force-Summary:</h3>
        <div class="flex gap-4 flex-wrap">
          {% for force_name, count in data.force_summary.items %}
            <span class="px-3 py-1 bg-blue-800 text-green-800 rounded-full shadow-inner">
              {{ force_name }}: {{ count }}
            </span>
          {% endfor %}
        </div>
      </div>

      {% if data.members %}
      <div class="overflow-x-auto">
        <table class="w-full border-collapse text-center text-gray-800 shadow rounded-lg">
          <thead class="bg-gradient-to-r from-amber-400 to-yellow-300 text-gray-900 font-semibold">
            <tr >
              <th class="p-3 border">Ser</th>
              <th class="p-3 border">No</th>
              <th class="p-3 border">Name</th>
              <th class="p-3 border">Rank</th>
              <th class="p-3 border">Force</th>
              <th class="p-3 border">Join in RAB</th>
              <th class="p-3 border">NID</th>
              <th class="p-3 border">Email</th>
              <th class="p-3 border">Phone</th>
              <th class="p-3 border">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for member in data.members %}
            <tr class="hover:bg-amber-50 transition">
              <td class="p-3 border">{{ forloop.counter }}</td>
              <td class="p-3 border">{{ member.no }}</td>
              <td class="p-3 border">{{ member.name }}</td>
              <td class="p-3 border">{{ member.rank }}</td>
              <td class="p-3 border">{{ member.force.name }}</td>
              <td class="p-3 border">{{ member.joining_date }}</td>
              <td class="p-3 border">{{ member.nid }}</td>
              <td class="p-3 border">{{ member.email }}</td>
              <td class="p-3 border">{{ member.phone }}</td>
              <td class="p-3 border flex justify-center gap-2">
                <a href="{% url 'edit-member' member.id %}"
                   class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm transition">Edit</a> 
                   <form action="" method="POST">

                   </form>
                <a href="{% url 'delete-member' member.id %}"
                   class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition"
                   onclick="return confirm('Are you sure you want to delete this member?')">Delete</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>

{% else %}
  <!-- üîπ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶¨‡¶ø‡¶ï ‡¶≠‡¶ø‡¶â -->
  <div class="max-w-5xl mx-auto mt-10 bg-white p-6 rounded-xl shadow">
    <div class="flex justify-between items-center mb-4 border-b pb-3">
      <h2 class="text-2xl font-semibold mb-4">{{ company.name }}</h2>
      <p class="text-gray-600 mb-2">Total Members: {{ member_count }}</p>
    </div>

    <!-- ‚úÖ Force-wise summary -->
    <div class="mb-4">
      <h3 class="text-lg font-semibold mb-2">Force-wise Summary:</h3>
      <div class="flex gap-4 flex-wrap">
        {% for force_name, count in force_summary.items %}
          <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full shadow-inner">
            {{ force_name }}: {{ count }}
          </span>
        {% endfor %}
      </div>
    </div>

    {% if members %}
    <div class="overflow-x-auto">
      <table class="w-full border-collapse text-center text-gray-800 shadow rounded-lg">
        <thead class="bg-gradient-to-r from-amber-400 to-yellow-300 text-green-900 font-semibold">
          <tr>
            <th class="p-3 border">Ser</th>
            <th class="p-3 border">No</th>
            <th class="p-3 border">Name</th>
            <th class="p-3 border">Rank</th>
            <th class="p-3 border">Force</th>
            <th class="p-3 border">Join in RAB</th>
            <th class="p-3 border">NID</th>
            <th class="p-3 border">Email</th>
            <th class="p-3 border">Phone</th>
            <th class="p-3 border">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for member in members %}
          <tr class="hover:bg-amber-50 transition">
            <td class="p-3 border">{{ forloop.counter }}</td>
            <td class="p-3 border">{{ member.no }}</td>
            <td class="p-3 border">{{ member.name }}</td>
            <td class="p-3 border">{{ member.rank }}</td>
            <td class="p-3 border">{{ member.force.name }}</td>
            <td class="p-3 border">{{ member.joining_date }}</td>
            <td class="p-3 border">{{ member.nid }}</td>
            <td class="p-3 border">{{ member.email }}</td>
            <td class="p-3 border">{{ member.phone }}</td>
            <td class="p-3 border flex justify-center gap-2">
              <a href="{% url 'edit-member' member.id %}"
                 class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm transition">Edit</a>
              <a href="{% url 'delete-member' member.id %}"
                 class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition"
                 onclick="return confirm('Are you sure you want to delete this member?')">Delete</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </div>
{% endif %}

{% endblock tasks %}
